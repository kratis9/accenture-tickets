{"ast":null,"code":"import { client } from \"./api-client\";\nimport { deleteStorage, safeStorageGet, safeStorageSet } from \"./storage-client\";\nimport Config from \"../config\";\nconst TOKEN_URL = `/atr-gateway/identity-management/api/v1/auth/short-token?useDeflate=true`;\nconst TOKEN_KEY = \"apiToken\";\nconst token = safeStorageGet(TOKEN_KEY);\n/**\n * The function is used to fetch the token for accessing dashboard data. I am using WebStorage to minimize the number of the token requests. \n * I have use sesstion storage to consider the\n * @returns token:string\n */\n\nasync function fetchToken() {\n  let token = safeStorageGet(TOKEN_KEY);\n\n  if (token) {\n    return token;\n  } else {\n    const user = {\n      username: Config.username,\n      password: Config.password,\n      snowEnabled: true\n    };\n    const headers = {\n      method: \"POST\",\n      accept: \"*/*\",\n      \"Content-Type\": \"application/json\"\n    };\n    return client(TOKEN_URL, {\n      method: \"POST\",\n      body: JSON.stringify(user),\n      headers\n    }).then(response => {\n      const value = response.data.token;\n      safeStorageSet(TOKEN_KEY, value);\n      return response.data.token;\n    });\n  }\n}\n\nfunction resetToken() {\n  deleteStorage(TOKEN_KEY);\n  fetchToken();\n}\n\nexport { fetchToken, resetToken, token };","map":{"version":3,"sources":["/Users/kratichauhan/tickets-app/src/utils/auth-provider.ts"],"names":["client","deleteStorage","safeStorageGet","safeStorageSet","Config","TOKEN_URL","TOKEN_KEY","token","fetchToken","user","username","password","snowEnabled","headers","method","accept","body","JSON","stringify","then","response","value","data","resetToken"],"mappings":"AAAA,SAASA,MAAT,QAAuB,cAAvB;AACA,SAASC,aAAT,EAAwBC,cAAxB,EAAwCC,cAAxC,QAA8D,kBAA9D;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,MAAMC,SAAS,GAAI,0EAAnB;AACA,MAAMC,SAAS,GAAG,UAAlB;AAEA,MAAMC,KAAK,GAAGL,cAAc,CAACI,SAAD,CAA5B;AACA;AACA;AACA;AACA;AACA;;AACA,eAAeE,UAAf,GAA6C;AAC3C,MAAID,KAAK,GAAGL,cAAc,CAACI,SAAD,CAA1B;;AACA,MAAIC,KAAJ,EAAW;AACT,WAAOA,KAAP;AACD,GAFD,MAEO;AACL,UAAME,IAAI,GAAG;AACXC,MAAAA,QAAQ,EAAEN,MAAM,CAACM,QADN;AAEXC,MAAAA,QAAQ,EAAEP,MAAM,CAACO,QAFN;AAGXC,MAAAA,WAAW,EAAE;AAHF,KAAb;AAKA,UAAMC,OAAoB,GAAG;AAC3BC,MAAAA,MAAM,EAAE,MADmB;AAE3BC,MAAAA,MAAM,EAAE,KAFmB;AAG3B,sBAAgB;AAHW,KAA7B;AAMA,WAAOf,MAAM,CAACK,SAAD,EAAY;AACvBS,MAAAA,MAAM,EAAE,MADe;AAEvBE,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeT,IAAf,CAFiB;AAGvBI,MAAAA;AAHuB,KAAZ,CAAN,CAIJM,IAJI,CAIEC,QAAD,IAAc;AACpB,YAAMC,KAAK,GAAID,QAAD,CAAkBE,IAAlB,CAAuBf,KAArC;AAEAJ,MAAAA,cAAc,CAACG,SAAD,EAAYe,KAAZ,CAAd;AACA,aAAQD,QAAD,CAAkBE,IAAlB,CAAuBf,KAA9B;AACD,KATM,CAAP;AAUD;AACF;;AACD,SAASgB,UAAT,GAAsB;AACpBtB,EAAAA,aAAa,CAACK,SAAD,CAAb;AACAE,EAAAA,UAAU;AACX;;AAED,SAASA,UAAT,EAAqBe,UAArB,EAAiChB,KAAjC","sourcesContent":["import { client } from \"./api-client\"\nimport { deleteStorage, safeStorageGet, safeStorageSet } from \"./storage-client\"\nimport Config from \"../config\"\nconst TOKEN_URL = `/atr-gateway/identity-management/api/v1/auth/short-token?useDeflate=true`\nconst TOKEN_KEY = \"apiToken\"\n\nconst token = safeStorageGet(TOKEN_KEY)\n/**\n * The function is used to fetch the token for accessing dashboard data. I am using WebStorage to minimize the number of the token requests. \n * I have use sesstion storage to consider the\n * @returns token:string\n */\nasync function fetchToken(): Promise<string> {\n  let token = safeStorageGet(TOKEN_KEY)\n  if (token) {\n    return token\n  } else {\n    const user = {\n      username: Config.username,\n      password: Config.password,\n      snowEnabled: true,\n    }\n    const headers: HeadersInit = {\n      method: \"POST\",\n      accept: \"*/*\",\n      \"Content-Type\": \"application/json\",\n    }\n\n    return client(TOKEN_URL, {\n      method: \"POST\",\n      body: JSON.stringify(user),\n      headers,\n    }).then((response) => {\n      const value = (response as any).data.token\n\n      safeStorageSet(TOKEN_KEY, value)\n      return (response as any).data.token as string\n    })\n  }\n}\nfunction resetToken() {\n  deleteStorage(TOKEN_KEY)\n  fetchToken()\n}\n\nexport { fetchToken, resetToken, token }\n"]},"metadata":{},"sourceType":"module"}